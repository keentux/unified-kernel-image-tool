.\" Automatically generated by Pandoc 3.6.4
.\"
.TH "UKI\-TOOL" "1" "May 21, 2025" "Version 1.5.0" "Manual of Unified Kernel Image Tool script"
.SH NAME
Unified Kernel Image Tool (UKIT)
.SH SYNOPSIS
\f[B]uki\-tool\f[R] [help|verbose|quiet] COMMANDS [\f[I]OPTION\f[R]]...
.SH DESCRIPTION
Tool that regroups useful command dealing with the Unified Kernel Image
(UKI) and static initrd project.
Write in shell script, and adapted to the \f[B]packaging\f[R].
.SH COMMANDS
.SS create
Generate PCR keys and use them to create an UKI using the systemd tool
\[aq]ukify\[aq].
.IP \[bu] 2
\f[B]\-k\f[R]|\f[B]\-\-kerver\f[R]: Kernel Version [default: $(uname
\-r)]
.IP \[bu] 2
\f[B]\-i\f[R]|\f[B]\-\-initrd\f[R]: Path to the initrd [Default:
/usr/share/initrd/initrd\-dracut\-generic\-kerver.unsigned]
.IP \[bu] 2
\f[B]\-n\f[R]|\f[B]\-\-name\f[R]: Name to the UKI to generate [Default:
uki]
.IP \[bu] 2
\f[B]\-c\f[R]|\f[B]\-\-cmdline\f[R]: kernel cmdline [Default: rw rhgb]
.IP \[bu] 2
\f[B]\-o\f[R]|\f[B]\-\-output\f[R]: Output dir where to generate the
UKI.
[Default: $PWD]
.IP \[bu] 2
\f[B]help\f[R]: Print this helper
.SS extension
Generate an extension for an UKI \[aq]name\-ext.format\[aq].
.PP
If \[aq]uki\[aq] parameter is set, the extension will be optimized by
not taking into account the files already installed into it.
The extension will be lighter.
These extensions, depending on a specific uki, will have to be installed
in \[aq]/usr/lib/modules/KERV_VER/UKI_NAME.extrad.d/\[aq].
.PP
Without \[aq]uki\[aq], it will generate gloabal extension that could
extends all UKI.
It will need to be installed into
\[aq]/usr/lib/modules/uki.extra.d/\[aq].
.IP \[bu] 2
\f[B]\-n\f[R]|\f[B]\-\-name\f[R]: Extension\[aq]s name
.IP \[bu] 2
\f[B]\-p\f[R]|\f[B]\-\-packages\f[R]: List of packages to install into
the extension
.IP \[bu] 2
\f[B]\-f\f[R]|\f[B]\-\-format\f[R]: Extension format (squashfs by
default)
.IP \[bu] 2
\f[B]\-t\f[R]|\f[B]\-\-type\f[R]: Type of the extension (dir, raw)
.IP \[bu] 2
\f[B]\-u\f[R]|\f[B]\-\-uki\f[R]: Path to the referenced UKI (installed
one by default)
.IP \[bu] 2
\f[B]\-a\f[R]|\f[B]\-\-arch\f[R]: Specify an architecture See \c
.UR https://uapi-group.org/specifications/specs/extension_image
.UE \c
\ For the list of potential value.
Print this helper
.IP \[bu] 2
\f[B]\-\-no\-deps\f[R]: Build without any dependences
.IP \[bu] 2
\f[B]help\f[R]: Print this helper
.SS grub2
Create or remove an entry to the grub2 menu.
If initrd argurment is provided, uki shouldn\[aq]t, and vice versa.
.PP
If the initrd provided isn\[aq]t in the boot partition, it will copy it
in \[aq]/boot\[aq].
.PP
If the uki provided isn\[aq]t in the the efi partition, it will copy it
in \[aq]/boot/efi/EFI/opensuse\[aq].
.PP
When remove is asked, \-\-uki should point to the installed uki (in
\[aq]/boot partition\[aq]).
.IP \[bu] 2
\f[B]\-add\f[R]|\f[B]\-\-remove\f[R]: Add/Remove grub2 entry (mandatory)
.IP \[bu] 2
\f[B]\-k\f[R]|\f[B]\-\-kerver\f[R]: Kernel Version [Default:
6.7.6\-1\-default]
.IP \[bu] 2
\f[B]\-i\f[R]|\f[B]\-\-initrd\f[R]: Path to the initrd
.IP \[bu] 2
\f[B]\-u\f[R]|\f[B]\-\-uki\f[R]: Path to the UKI
.IP \[bu] 2
\f[B]\-e\f[R]|\f[B]\-\-efi\f[R]: efi directory [Default EFI/Linux]
.IP \[bu] 2
\f[B]\-D\f[R]|\f[B]\-\-default\f[R]: set entry as default (only with
\-\-add)
.IP \[bu] 2
\f[B]\-t\f[R]|\f[B]\-\-title\f[R]: Entry\[aq]s title
.IP \[bu] 2
\f[B]\-c\f[R]|\f[B]\-\-cmdline\f[R]: Kernel command line
.IP \[bu] 2
\f[B]help\f[R]: Print this helper
.SS sdboot
Create or remove an entry to the UKI for sdboot installed for a
specified Kernel version.
It will search binary from
\[aq]/usr/lib/modules/\f[I]k\f[R]\f[I]e\f[R]\f[I]r\f[R]~\f[I]v\f[R]~\f[I]e\f[R]\f[I]r\f[R]/image\[aq].
.IP \[bu] 2
\f[B]\-\-add\f[R]: Add entry
.IP \[bu] 2
\f[B]\-\-remove\f[R]: Remove entry
.IP \[bu] 2
\f[B]\-k\f[R]|\f[B]\-\-kerver\f[R]: Kernel Version [Default:
6.7.7\-1\-default]
.IP \[bu] 2
\f[B]\-i\f[R]|\f[B]\-\-initrd\f[R]: Path to the initrd
.IP \[bu] 2
\f[B]\-i\f[R]|\f[B]\-\-image\f[R]: Image name (should be end by .efi)
.IP \[bu] 2
\f[B]\-a\f[R]|\f[B]\-\-arch\f[R]: Architecture to use [Default
\[aq]uname \-m\[aq]]
.IP \[bu] 2
\f[B]\-e\f[R]|\f[B]\-\-efi\f[R]: efi directory [Default EFI/Linux]
.IP \[bu] 2
\f[B]\-D\f[R]|\f[B]\-\-default\f[R]: set entry as default (only with
\-\-add)
.IP \[bu] 2
\f[B]\-t\f[R]|\f[B]\-\-title\f[R]: Entry\[aq]s title
.IP \[bu] 2
\f[B]\-c\f[R]|\f[B]\-\-cmdline\f[R]: Kernel command line
.IP \[bu] 2
\f[B]help\f[R]: Print this helper
.SS addon
Generate an addon with a custom .cmdline section using the systemd tool
\[aq]ukify\[aq]
.IP \[bu] 2
\f[B]\-c\f[R]|\f[B]\-\-cmdline\f[R]: To put in .cmdline section
.IP \[bu] 2
\f[B]\-n\f[R]|\f[B]\-\-name\f[R]: Name of the addon
.IP \[bu] 2
\f[B]\-o\f[R]|\f[B]\-\-output\f[R]: Output dir where to generate the
addon.
[Default: $PWD]
.IP \[bu] 2
\f[B]help\f[R]: Print this helper
.SH EXAMPLES
.SS uki\-tool create \-k 6.7.6\-1\-default \-n uki\-0.1.0.efi \-o /usr/lib/modules/6.7.6\-1\-default/
Create an unified kernel image, named \[aq]uki\-0.1.0.efi\[aq] taking
the kernel \[aq]6.7.6\-1\-default\[aq] and stored it into
\[aq]/usr/lib/modules/6.7.6\-1\-default/\[aq].
.SS uki\-tool extension \-n \[dq]debug\[dq] \-p \[dq]strace,gdb\[dq] \-t \[dq]raw\[dq]
Create a raw uki\[aq]s extension, named \[dq]debug\[dq], containing
\[aq]strace,gdb\[aq] with their dependencies.
.SS uki\-tool grub2 \-\-add \-k 6.3.4\-1\-default \-u /boot/efi/EFI/opensuse/uki.efi
Add an entry to the grub bootloader.
.SS uki\-tool sdboot \-\-add \-k 6.3.4\-1\-default \-u uki\-0.1.0.efi
Add an entry to sdboot bootloader.
.SS uki\-tool addon \-c =\[aq]|Test uki addon|\[aq] \-o /boot/efi/EFI/loader/addons \-n test
Create an uki\[aq]s addon named \[dq]test\[dq] used to add \[dq]|Test
uki addon|\[dq] into the kernel cmdline.
.SH AUTHOR
Valentin Lefebvre \c
.MT valentin.lefebvre@suse.com
.ME \c
.SH REPORTING ISSUES
Submit bug reports only to: \c
.UR https://github.com/keentux/unified-kernel-image-tool/issues
.UE \c
.SH COPYRIGHT
Copyright Â© 2024 Valentin Lefebvre.
MIT License.
.SH SEE ALSO
Unified Kernel Image Tool at \c
.UR https://github.com/keentux/unified-kernel-image-tool/blob/main/README.md
.UE \c
